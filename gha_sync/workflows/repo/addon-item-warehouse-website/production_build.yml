---
name: Build (Production)

on:
  push:
    branches:
      - release/*

permissions:
  contents: write
  pull-requests: write

jobs:
  get-release-tag:
    name: Get Release Tag
    uses: worgarside/github-config-files/.github/workflows/__get_release_tag.yml@main
    with:
      branch-name: ${{ github.ref }}
    secrets: inherit

  run-production-build:
    name: Run Production Build
    needs:
      - get-release-tag
    uses: worgarside/github-config-files/.github/workflows/__build_and_publish.yml@main
    with:
      build-branch: ${{ github.ref }}
      build-type: node
      commit-build-directory: false
      environment: production
      node-build-directory: item_warehouse_website
      release-tag: ${{ needs.get-release-tag.outputs.release-tag }}
    secrets: inherit
